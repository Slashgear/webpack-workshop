# Les bases

> Pour démarrer cet exercice, sois sûr d'être dans le dossier `./packages/novice/basic`.
> Sois également sûr d'avoir [installé ce dépôt d'abord](../README.md#install)

## Introduction

Ce premier exemple a pour but de vous aidez à comprendre pourquoi webpack existe et son usage basique.

Dans cette application, nous avons défini deux modules CommonJS (modules utilisés [sur NodeJS](https://nodejs.org/docs/latest/api/modules.html)).
Ils sont tous les deux chargées dans `index.html`.

Si vous n'êtes pas famillier des capacités des navigateurs, sachez que les modules CommonJS n'y seront pas fonctionnels.
Un navigateur ne peut pas gérer l'import direct de dépendance NodeJS.

Ici le graph de dépendance de l'application ressemble à:

```
title.js
      <- color.js
             <- node_modules/lodash
```

## La solution webpack

webpack est un package NodeJS qui génère un _bundle_ (concaténation de modules), basé sur la résolution d'un arbre de dépendances.

### Étape 1: Mise en place d'un configuration simple

Pour configurer webpack, vous devez créer exporter un module dans le fichier nommé `webpack.config.js` à la racine de votre projet.
Couplé avec un outil comme `webpack-cli`, vous pourrez alors facilement lancer un _build_.

```js
const path = require("path");

module.exports = {
  entry: "./src/title.js", // Le module racine de l'arbre de dépendance.
  output: {
    filename: "main.js",
    path: path.resolve(__dirname, "dist")
  }
};
```

Après avoir lancé la commande `yarn webpack`, un nouveau fichier `main.js` dans le dossier `dist` devrait être généré.

### Étape 2: Changer les cibles des scripts d'index.html

Pour l'instant, `index.html` ne référence pas le fichier _output_, nous devons donc changer cela.
Il suffit de changer
To do so, just change the `<script/>` tag in your `index.html` to reference the file generated by webpack.

```html{10}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Simple JS file</title>
    <meta name="description" content="Simple JS file" />
  </head>
  <body>
    <h1>This title will change !</h1>
    <script src="dist/main.js"></script>
  </body>
</html>
```

### Étape 3: Définir un script pour lancer webpack

Grâce à un `npm script`, vous allez définir une commande pour lancer le build de webpack.

```json{13,14,15}
{
  "name": "@novice/basic",
  "version": "1.0.0",
  "license": "MIT",
  "private": true,
  "dependencies": {
    "lodash": "^4.17.11"
  },
  "devDependencies": {
    "webpack": "^4.28.4",
    "webpack-cli": "^3.2.1"
  },
  "scripts": {
    "build": "webpack"
  }
}
```

Maintenant lance le `build` et ouvre le fichier `index.html` dans ton navigateur.

```bash
yarn build
```

Regarde le _bundle_ généré et teste ton application.

### Que s'est-il passé ?

ici webpack, grâce à son fichier de configuration, a construit un arbre de dépendance en se basant sur l'entry `title.js`.
Une fois cet arbre résolu, en suivant sa configuration de "sortie", il a généré un fichier `main.js` contenant l'ensemble des modules de l'arbre de dépendances sous la forme de chunks.

N'hésitez pas à jeter un coup d'oeil à ce qui est contenu dans ce fichier généré.
